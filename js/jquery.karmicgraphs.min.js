(function(a){String.prototype.format=function(){var d=this;for(var b=0;b<arguments.length;b++){var c=new RegExp("\\{"+b+"\\}","gm");d=d.replace(c,arguments[b])}return d};a.fn.karmicGraph=function(g,p){var f=a.extend({color:"blue",showLabel:true,label:"{val} cosas para el {0} num. {1} ",outLabel:"Ponte encima de una columna",noLabel:" -- ",freeColumn:-1},p);var c=124;if(g.length>c){factor=-1;if(f.freeColumn>0){factor=1}g=g.slice(c*factor)}var d=g.length,e=c-d;var b="graphHBlue";switch(f.color){case"blue":b="graphHBlue";break;case"red":b="graphHRed";break;case"green":b="graphHGreen";break;case"yellow":b="graphHYellow";break;case"orange":b="graphHOrange";break;case"dark-orange":b="graphHOrangeDark";break;case"violet":b="graphHVioleta";break;case"gold":b="graphHGold";break;default:b="graphHBlue";break}var o=document.createElement("div");o.setAttribute("class",b);var m=a('<div><span style="height:0%"></span><span class="graphBarZero"></span><span class="bar-label" style="display:none">'+f.noLabel+"</span></div>");for(i=0;i<e;i++){m.clone().appendTo(o)}var n=0,j=0;dataArray=new Array();while(n<d){var l=parseInt(g[n][0]);if(j<l){j=l}n++}if(f.freeColumn>0){g.reverse()}n=0;while(n<d){percentage=(parseInt(g[n][0])*100/j);k=f.label.replace("{val}",g[n][0]);k=String.prototype.format.apply(k,g[n][1]);var h=a('<div><span style="height:'+percentage+'%"></span><span class="graphBarZero"></span><span class="bar-label" style="display:none">'+k+"</span></div>");if(f.freeColumn<0){h.appendTo(o)}else{a(o).prepend(h)}n++}a(this).find("*").remove();a(o).appendTo(this);if(f.showLabel==true){var k=a('<div class="graphBarData"></div>');a(k).appendTo(this)}a("div",o).hover(function(){barra=a(this);barra.find("span").addClass("hover");texto=barra.find(".bar-label").first().text();barra.parent().parent().find(".graphBarData").first().text(texto)},function(){a(this).find("span").removeClass("hover");barra.parent().parent().find(".graphBarData").first().text(f.outLabel)})}})(jQuery);