(function(b){String.prototype.format=function(){var e=this;for(var c=0;c<arguments.length;c++){var d=new RegExp("\\{"+c+"\\}","gm");e=e.replace(d,arguments[c])}return e};var a={init:function(u,e){var s={type:"flatbars",color:"blue",showLabel:true,label:"{val} cosas para el {0} num. {1} ",outLabel:"Ponte encima de una columna",noLabel:" -- ",freeColumn:-1,url:"",time:0,width:620},d;s=b.extend(s,e);var h=this.data("karmicgraph");if(!h){h={}}h.settings=s;var f=s.type=="flatbars"?"H":"W";switch(s.color){case"blue":graphBarClass="graph"+f+"Blue";break;case"red":graphBarClass="graph"+f+"Red";break;case"green":graphBarClass="graph"+f+"Green";break;case"yellow":graphBarClass="graph"+f+"Yellow";break;case"orange":graphBarClass="graph"+f+"Orange";break;case"dark-orange":graphBarClass="graph"+f+"OrangeDark";break;case"violet":graphBarClass="graph"+f+"Violeta";break;case"gold":graphBarClass="graph"+f+"Gold";break;default:graphBarClass="grap"+f+"Blue";break}d=document.createElement("div");d.setAttribute("class","karmicgraph");var c=s.type=="flatbars"?Math.floor((s.width-20)/20):Math.floor(s.width/5);s.width=s.type=="flatbars"?(c*20)+20:c*5;b(d).css("width",s.width+"px");var r=document.createElement("div");r.setAttribute("class","graphCont");var o=s.type=="flatbars"?120:80;var m=document.createElement("div");m.setAttribute("class",graphBarClass);if(s.type=="flatbars"){b(m).css("padding-left","20px")}if(u.length>c){if(s.freeColumn>0){u=u.slice(0,c)}else{u=u.slice(c*-1)}}var j=u.length,g=c-j;var v=0,p=0;dataArray=new Array();while(v<j){var l=parseInt(u[v][0]);if(p<l){p=l}v++}if(s.type=="flatbars"){var n=document.createElement("div");n.setAttribute("class","graphLines");p=Math.ceil(p/0.95);while(p%4!=0){p++}var w=b(n);w.append('<span class="first">'+p+"</span>").append('<span class="second">'+p*3/4+"</span>").append('<span class="third">'+p/2+"</span>").append('<span class="fourth">'+p/4+"</span>");w.appendTo(r)}var t=b('<div><span class="bar" style="height:0%"></span><span class="graphBarZero"></span><span class="bar-label" style="display:none">'+s.noLabel+"</span></div>");for(i=0;i<g;i++){t.clone().appendTo(m)}if(s.freeColumn>0){u.reverse()}v=0;while(v<j){percentage=(parseInt(u[v][0])*100/p);k=s.label.replace("{val}",u[v][0]);k=String.prototype.format.apply(k,u[v][1]);var q=b('<div><span class="bar" style="height:'+percentage+'%"></span><span class="graphBarZero"></span><span class="bar-label" style="display:none">'+k+"</span></div>");if(s.freeColumn<0){q.appendTo(m)}else{b(m).prepend(q)}v++}b(m).appendTo(r);b(r).appendTo(d);if(s.showLabel==true){var k=b('<div class="graphBarData">'+s.outLabel+"</div>");b(k).appendTo(d)}b(d).appendTo(this);b("div",m).hover(function(){barra=b(this);barra.find("span").addClass("hover");texto=barra.find(".bar-label").first().text();b(d).find(".graphBarData").first().text(texto)},function(){b(this).find("span").removeClass("hover");b(d).find(".graphBarData").first().text(s.outLabel)});h.graph=d;this.data("karmicgraph",h)},update:function(){if("url"!=""){}else{b.error("You have to configure de url setting to use this method")}},setSetting:function(c,d){settings[c]=d}};b.fn.karmicGraph=function(c){if(a[c]){return a[c].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof c==="object"||!c){return a.init.apply(this,arguments)}else{b.error("Method "+c+" does not exist on jQuery.karmicGraph")}}}})(jQuery);